/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

class WidgetHandler {
}
// Remove Widgets in CodeMirror Editor
WidgetHandler.clearWidgets = (cm) => {
    var lastLine = cm.lastLine();
    for (let i = 0; i <= lastLine; i++) {
        const line = cm.lineInfo(i);
        WidgetHandler.clearLineWidgets(line);
    }
};
// Clear Single Line Widget
WidgetHandler.clearLineWidgets = (line) => {
    if (line.widgets) {
        for (const wid of line.widgets) {
            if (wid.className === 'oz-image-widget') {
                wid.clear();
            }
        }
    }
};
class LinkHandler {
}
LinkHandler.link_regex = /(http[s]?:\/\/)([^\/\s]+\/)(.*)/;
LinkHandler.image_http_regex_3 = /!\[\[[a-z][a-z0-9+\-.]+:\/.*\]\]/;
LinkHandler.image_http_regex_4 = /!\[[^)]*\]\([a-z][a-z0-9+\-.]+:\/[^)]*\)/;
// Check if String is a link
LinkHandler.path_is_a_link = (path) => {
    let match = path.match(LinkHandler.link_regex);
    return match ? true : false;
};
// Check line if it is a link
LinkHandler.get_link_in_line = (line) => {
    const match_3 = line.match(LinkHandler.image_http_regex_3);
    const match_4 = line.match(LinkHandler.image_http_regex_4);
    if (match_3) {
        return { result: match_3, linkType: 3 };
    }
    else if (match_4) {
        return { result: match_4, linkType: 4 };
    }
    return { result: false, linkType: 0 };
};
class PDFHandler {
}
// Regex for [[ ]] format
PDFHandler.pdf_regex_1 = /!\[\[.*(pdf)\]\]/;
PDFHandler.pdf_name_regex_1 = /(?<=\[\[).*.pdf/;
// Regex for ![ ]( ) format
PDFHandler.pdf_regex_2 = /!\[(^$|.*)\]\(.*(pdf)\)/;
PDFHandler.pdf_name_regex_2 = /(?<=\().*.pdf/;
// Check line if it is a PDF
PDFHandler.get_pdf_in_line = (line) => {
    const match_1 = line.match(PDFHandler.pdf_regex_1);
    const match_2 = line.match(PDFHandler.pdf_regex_2);
    if (match_1) {
        return { result: match_1, linkType: 1 };
    }
    else if (match_2) {
        return { result: match_2, linkType: 2 };
    }
    return { result: false, linkType: 0 };
};
PDFHandler.get_pdf_name = (linkType, match) => {
    let pdf_name_regex;
    if (linkType == 1)
        pdf_name_regex = PDFHandler.pdf_name_regex_1;
    if (linkType == 2)
        pdf_name_regex = PDFHandler.pdf_name_regex_2;
    var file_name_match = match[0].match(pdf_name_regex);
    return file_name_match[0];
};
class ImageHandler {
}
// General Image Regex 
ImageHandler.image_regex = /.*.(jpe?g|png|gif|svg|bmp|excalidraw)/;
// Regex for [[ ]] format
ImageHandler.image_line_regex_1 = /!\[\[.*?(jpe?g|png|gif|svg|bmp|excalidraw).*?\]\]/;
ImageHandler.file_name_regex_1 = /(?<=\[\[).*(jpe?g|png|gif|svg|bmp|excalidraw)/;
// Regex for ![ ]( ) format
ImageHandler.image_line_regex_2 = /!\[(^$|.*?)\]\(.*?(jpe?g|png|gif|svg|bmp|excalidraw)\)/;
ImageHandler.file_name_regex_2 = /(?<=\().*(jpe?g|png|gif|svg|bmp|excalidraw)/;
// Regex for Links
ImageHandler.file_name_regex_3 = /(?<=\[\[).*(?=\|)|(?<=\[\[).*(?=\]\])/;
ImageHandler.file_name_regex_4 = /(?<=\().*(?=\))/;
// Check line if it is image
ImageHandler.get_image_in_line = (line) => {
    const match_1 = line.match(ImageHandler.image_line_regex_1);
    const match_2 = line.match(ImageHandler.image_line_regex_2);
    if (match_1) {
        return { result: match_1, linkType: 1 };
    }
    else if (match_2) {
        return { result: match_2, linkType: 2 };
    }
    return { result: false, linkType: 0 };
};
// Image Name and Alt Text
ImageHandler.getFileNameAndAltText = (linkType, match) => {
    /*
        linkType 1: ![[myimage.jpg|#x-small]], linkType 3: ![[https://image|#x-small]],
        linkType 2: ![#x-small](myimage.jpg),  linkType 4: ![#x-small](https://image)
        returns { fileName: '', altText: '' }
    */
    var file_name_regex;
    var alt_regex;
    if (linkType == 1 || linkType == 3) {
        if (linkType == 1)
            file_name_regex = ImageHandler.file_name_regex_1;
        if (linkType == 3)
            file_name_regex = ImageHandler.file_name_regex_3;
        alt_regex = /(?<=\|).*(?=]])/;
    }
    else if (linkType == 2 || linkType == 4) {
        if (linkType == 2)
            file_name_regex = ImageHandler.file_name_regex_2;
        if (linkType == 4)
            file_name_regex = ImageHandler.file_name_regex_4;
        alt_regex = /(?<=\[)(^$|.*)(?=\])/;
    }
    var file_match = match[0].match(file_name_regex);
    var alt_match = match[0].match(alt_regex);
    return {
        fileName: file_match ? file_match[0] : '',
        altText: alt_match ? alt_match[0] : ''
    };
};
// Checking the Alt 100x100 (WIDTHxHEIGHT) format
ImageHandler.altWidthHeight = (altText) => {
    const widthHeightRegex = /[0-9]+x[0-9]+/;
    const widthRegex = /[0-9]+/;
    var match = altText.match(widthHeightRegex);
    if (match) {
        var index = match[0].indexOf('x');
        return {
            width: parseInt(match[0].substr(0, index)),
            height: parseInt(match[0].substr(index + 1))
        };
    }
    else {
        var widthMatch = altText.match(widthRegex);
        if (widthMatch)
            return { width: parseInt(widthMatch[0]) };
    }
    return false;
};
// Check if path is an image
ImageHandler.is_an_image = (path) => {
    var match = path.match(ImageHandler.image_regex);
    if (match)
        return true;
    return false;
};
class ObsidianHelpers {
}
// Getting Active Markdown File
ObsidianHelpers.getActiveNoteFile = (workspace) => {
    return workspace.getActiveFile();
};
// Get Active Editor
ObsidianHelpers.getCmEditor = (workspace) => {
    var _a, _b;
    return (_b = (_a = workspace.getActiveViewOfType(obsidian.MarkdownView)) === null || _a === void 0 ? void 0 : _a.sourceMode) === null || _b === void 0 ? void 0 : _b.cmEditor;
};
// Get Full Path of the image
ObsidianHelpers.getPathOfImage = (vault, image) => {
    return vault.getResourcePath(image) + '?' + image.stat.mtime;
};
ObsidianHelpers.getFileCmBelongsTo = (cm, workspace) => {
    var _a;
    let leafs = workspace.getLeavesOfType("markdown");
    for (let i = 0; i < leafs.length; i++) {
        // @ts-ignore
        if (leafs[i].view instanceof obsidian.MarkdownView && ((_a = leafs[i].view.sourceMode) === null || _a === void 0 ? void 0 : _a.cmEditor) == cm) {
            // @ts-ignore
            return leafs[i].view.file;
        }
    }
    return null;
};

// Check Single Line
const check_line = (cm, line_number, targetFile, app, settings, changedFilePath) => __awaiter(void 0, void 0, void 0, function* () {
    // Get the Line edited
    const line = cm.lineInfo(line_number);
    if (line === null)
        return;
    // Check if the line is an internet link
    const link_in_line = LinkHandler.get_link_in_line(line.text);
    const img_in_line = ImageHandler.get_image_in_line(line.text);
    // Clear the widget if link was removed
    var line_image_widget = line.widgets ? line.widgets.filter((wid) => wid.className === 'oz-image-widget') : false;
    if (line_image_widget && !(img_in_line.result || link_in_line.result))
        line_image_widget[0].clear();
    var sourcePath = '';
    // Render PDF if it is turned on
    if (settings && settings.renderPDF) {
        // Check if the line is a  PDF 
        const pdf_in_line = PDFHandler.get_pdf_in_line(line.text);
        // If PDF Regex Matches
        if (pdf_in_line.result) {
            // Clear the Line Widgets
            WidgetHandler.clearLineWidgets(line);
            // Get Source Path
            if (targetFile != null)
                sourcePath = targetFile.path;
            // Get PDF File
            var pdf_name = PDFHandler.get_pdf_name(pdf_in_line.linkType, pdf_in_line.result);
            // Create URL for Link and Local PDF 
            var pdf_path = '';
            if (LinkHandler.path_is_a_link(pdf_name)) {
                pdf_path = pdf_name;
            }
            else {
                // Get the PDF File Object
                var pdfFile = app.metadataCache.getFirstLinkpathDest(decodeURIComponent(pdf_name), sourcePath);
                // Create Object URL
                var buffer = yield app.vault.adapter.readBinary(obsidian.normalizePath(pdfFile.path));
                var arr = new Uint8Array(buffer);
                var blob = new Blob([arr], { type: 'application/pdf' });
                pdf_path = URL.createObjectURL(blob);
            }
            // Create the Widget
            var pdf_widget = document.createElement('embed');
            pdf_widget.src = pdf_path;
            pdf_widget.type = 'application/pdf';
            pdf_widget.width = '500';
            pdf_widget.height = '650';
            // Add Widget in Line
            cm.addLineWidget(line_number, pdf_widget, { className: 'oz-image-widget' });
            // End Rendering of the line
            return;
        }
    }
    // If any of regex matches, it will add image widget
    if (link_in_line.result || img_in_line.result) {
        // Get the file name and alt text depending on format
        var filename = '';
        var alt = '';
        if (link_in_line.result) {
            // linkType 3 and 4
            filename = ImageHandler.getFileNameAndAltText(link_in_line.linkType, link_in_line.result).fileName;
            alt = ImageHandler.getFileNameAndAltText(link_in_line.linkType, link_in_line.result).altText;
        }
        else if (img_in_line.result) {
            filename = ImageHandler.getFileNameAndAltText(img_in_line.linkType, img_in_line.result).fileName;
            alt = ImageHandler.getFileNameAndAltText(img_in_line.linkType, img_in_line.result).altText;
        }
        // Create Image
        const img = document.createElement('img');
        var image = null;
        // Prepare the src for the Image
        if (link_in_line.result) {
            img.src = filename;
        }
        else {
            // Source Path
            if (targetFile != null) {
                sourcePath = targetFile.path;
            }
            else {
                let activeNoteFile = ObsidianHelpers.getActiveNoteFile(app.workspace);
                sourcePath = activeNoteFile ? activeNoteFile.path : '';
            }
            var imageFile = app.metadataCache.getFirstLinkpathDest(decodeURIComponent(filename), sourcePath);
            // Additional Check for Changed Files - helps updating only for changed image
            if (changedFilePath && imageFile && changedFilePath !== imageFile.path)
                return;
            if (filename.endsWith('excalidraw')) {
                // The file is an excalidraw drawing
                // @ts-ignore
                if (app.plugins.getPlugin('obsidian-excalidraw-plugin')) {
                    if (imageFile == null)
                        return;
                    var mtimeAlt = imageFile.stat.mtime + '-' + alt;
                    var loadedDrawing = document.querySelector(`[mtimeAlt='${mtimeAlt}']`);
                    if (loadedDrawing == null) {
                        // @ts-ignore
                        ExcalidrawAutomate.reset();
                        // @ts-ignore
                        image = yield ExcalidrawAutomate.createPNG(imageFile.path);
                        img.src = URL.createObjectURL(image);
                        img.setAttr("mtimeAlt", mtimeAlt);
                    }
                    else {
                        return;
                    }
                }
            }
            else {
                // The file is an image
                if (imageFile == null)
                    return;
                img.src = ObsidianHelpers.getPathOfImage(app.vault, imageFile);
            }
        }
        // Clear the image widgets if exists
        WidgetHandler.clearLineWidgets(line);
        // Image Properties
        var altSizer = ImageHandler.altWidthHeight(alt);
        if (altSizer) {
            img.width = altSizer.width;
            if (altSizer.height)
                img.height = altSizer.height;
        }
        img.alt = alt;
        // Add Image widget under the Image Markdown
        cm.addLineWidget(line_number, img, { className: 'oz-image-widget' });
    }
});
// Check All Lines Function
const check_lines = (cm, from, to, app, settings, changedFilePath) => {
    // Last Used Line Number in Code Mirror
    var file = ObsidianHelpers.getFileCmBelongsTo(cm, app.workspace);
    for (let i = from; i <= to; i++) {
        check_line(cm, i, file, app, settings, changedFilePath);
    }
};

class OzanImagePluginSettingsTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Image in Editor Settings' });
        new obsidian.Setting(containerEl)
            .setName('Render Toggle')
            .setDesc('Turn off this option if you want to stop rendering images, PDF and drawings. If you turn off, the other settings won\'t have an effect')
            .addToggle((toggle) => toggle
            .setValue(this.plugin.settings.renderAll)
            .onChange((value) => {
            this.plugin.handleToggleRenderAll(value);
            this.plugin.settings.renderAll = value;
            this.plugin.saveSettings();
        }));
        new obsidian.Setting(containerEl)
            .setName('Render PDF-s in Editor')
            .setDesc('Turn on this option if you want also PDF files to be rendered in Editor')
            .addToggle((toggle) => toggle
            .setValue(this.plugin.settings.renderPDF)
            .onChange((value) => {
            this.plugin.settings.renderPDF = value;
            this.plugin.saveSettings();
        }));
        new obsidian.Setting(containerEl)
            .setName('Refresh Images after Changes')
            .setDesc('Turn on this option if you want images to refreshed once you edit the original file')
            .addToggle((toggle) => toggle
            .setValue(this.plugin.settings.refreshImagesAfterChange)
            .onChange((value) => {
            this.plugin.handleRefreshImages(value);
            this.plugin.settings.refreshImagesAfterChange = value;
            this.plugin.saveSettings();
        }));
    }
}

const DEFAULT_SETTINGS = {
    renderAll: true,
    renderPDF: false,
    refreshImagesAfterChange: false
};
class OzanImagePlugin extends obsidian.Plugin {
    constructor() {
        super(...arguments);
        // Line Edit Changes
        this.codemirrorLineChanges = (cm, change) => {
            check_lines(cm, change.from.line, change.from.line + change.text.length - 1, this.app, this.settings);
        };
        // Only Triggered during initial Load
        this.handleInitialLoad = (cm) => {
            var lastLine = cm.lastLine();
            var file = ObsidianHelpers.getFileCmBelongsTo(cm, this.app.workspace);
            for (let i = 0; i < lastLine + 1; i++) {
                check_line(cm, i, file, this.app, this.settings);
            }
        };
        // Handle Toggle for renderAll
        this.handleToggleRenderAll = (newRenderAll) => {
            if (newRenderAll) {
                this.registerCodeMirror((cm) => {
                    cm.on("change", this.codemirrorLineChanges);
                    this.handleInitialLoad(cm);
                });
                if (this.settings.refreshImagesAfterChange)
                    this.app.vault.on('modify', this.handleFileModify);
            }
            else {
                this.app.workspace.iterateCodeMirrors((cm) => {
                    cm.off("change", this.codemirrorLineChanges);
                    WidgetHandler.clearWidgets(cm);
                });
                this.app.vault.off('modify', this.handleFileModify);
            }
        };
        // Handle Toggle for Refresh Images
        this.handleRefreshImages = (newRefreshImages) => {
            if (newRefreshImages) {
                this.app.vault.on('modify', this.handleFileModify);
            }
            else {
                this.app.vault.off('modify', this.handleFileModify);
            }
        };
        // Handle File Upload
        this.handleFileModify = (file) => {
            if (!(file instanceof obsidian.TFile))
                return;
            if (!ImageHandler.is_an_image(file.path))
                return;
            this.app.workspace.iterateCodeMirrors(cm => {
                var lastLine = cm.lastLine();
                check_lines(cm, 0, lastLine, this.app, this.settings, file.path);
            });
        };
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Image in Editor Plugin is loaded');
            this.addSettingTab(new OzanImagePluginSettingsTab(this.app, this));
            yield this.loadSettings();
            // Register event for each change
            this.addCommand({
                id: 'toggle-render-all',
                name: 'Toggle Render All',
                callback: () => {
                    this.handleToggleRenderAll(!this.settings.renderAll);
                    this.settings.renderAll = !this.settings.renderAll;
                    this.saveSettings();
                }
            });
            if (!this.settings.renderAll)
                return;
            this.registerCodeMirror((cm) => {
                cm.on("change", this.codemirrorLineChanges);
                this.handleInitialLoad(cm);
            });
            if (!this.settings.refreshImagesAfterChange)
                return;
            this.app.vault.on('modify', this.handleFileModify);
        });
    }
    onunload() {
        this.app.workspace.iterateCodeMirrors((cm) => {
            cm.off("change", this.codemirrorLineChanges);
            WidgetHandler.clearWidgets(cm);
        });
        this.app.vault.off('modify', this.handleFileModify);
        console.log('Image in Editor Plugin is unloaded');
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
}

module.exports = OzanImagePlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsInNyYy91dGlscy50cyIsInNyYy9jaGVjay1saW5lLnRzIiwic3JjL3NldHRpbmdzLnRzIiwic3JjL21haW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLlxyXG5cclxuUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55XHJcbnB1cnBvc2Ugd2l0aCBvciB3aXRob3V0IGZlZSBpcyBoZXJlYnkgZ3JhbnRlZC5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEhcclxuUkVHQVJEIFRPIFRISVMgU09GVFdBUkUgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZXHJcbkFORCBGSVRORVNTLiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SIEJFIExJQUJMRSBGT1IgQU5ZIFNQRUNJQUwsIERJUkVDVCxcclxuSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NXHJcbkxPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SXHJcbk9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1JcclxuUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmluZGV4T2YocFtpXSkgPCAwICYmIE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzLCBwW2ldKSlcclxuICAgICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19jcmVhdGVCaW5kaW5nID0gT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xyXG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9KTtcclxufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBvW2syXSA9IG1ba107XHJcbn0pO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBvKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIHApKSBfX2NyZWF0ZUJpbmRpbmcobywgbSwgcCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/IFwiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIiA6IFwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXkodG8sIGZyb20pIHtcclxuICAgIGZvciAodmFyIGkgPSAwLCBpbCA9IGZyb20ubGVuZ3RoLCBqID0gdG8ubGVuZ3RoOyBpIDwgaWw7IGkrKywgaisrKVxyXG4gICAgICAgIHRvW2pdID0gZnJvbVtpXTtcclxuICAgIHJldHVybiB0bztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxudmFyIF9fc2V0TW9kdWxlRGVmYXVsdCA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgdikge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIFwiZGVmYXVsdFwiLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2IH0pO1xyXG59KSA6IGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIG9bXCJkZWZhdWx0XCJdID0gdjtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKGsgIT09IFwiZGVmYXVsdFwiICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSBfX2NyZWF0ZUJpbmRpbmcocmVzdWx0LCBtb2QsIGspO1xyXG4gICAgX19zZXRNb2R1bGVEZWZhdWx0KHJlc3VsdCwgbW9kKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19jbGFzc1ByaXZhdGVGaWVsZEdldChyZWNlaXZlciwgc3RhdGUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHJlYWQgcHJpdmF0ZSBtZW1iZXIgZnJvbSBhbiBvYmplY3Qgd2hvc2UgY2xhc3MgZGlkIG5vdCBkZWNsYXJlIGl0XCIpO1xyXG4gICAgcmV0dXJuIGtpbmQgPT09IFwibVwiID8gZiA6IGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyKSA6IGYgPyBmLnZhbHVlIDogc3RhdGUuZ2V0KHJlY2VpdmVyKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRTZXQocmVjZWl2ZXIsIHN0YXRlLCB2YWx1ZSwga2luZCwgZikge1xyXG4gICAgaWYgKGtpbmQgPT09IFwibVwiKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBtZXRob2QgaXMgbm90IHdyaXRhYmxlXCIpO1xyXG4gICAgaWYgKGtpbmQgPT09IFwiYVwiICYmICFmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJpdmF0ZSBhY2Nlc3NvciB3YXMgZGVmaW5lZCB3aXRob3V0IGEgc2V0dGVyXCIpO1xyXG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3Qgd3JpdGUgcHJpdmF0ZSBtZW1iZXIgdG8gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiAoa2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIsIHZhbHVlKSA6IGYgPyBmLnZhbHVlID0gdmFsdWUgOiBzdGF0ZS5zZXQocmVjZWl2ZXIsIHZhbHVlKSksIHZhbHVlO1xyXG59XHJcbiIsImltcG9ydCB7IFdvcmtzcGFjZSwgTWFya2Rvd25WaWV3LCBWYXVsdCwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjbGFzcyBXaWRnZXRIYW5kbGVyIHtcblxuICAgIC8vIFJlbW92ZSBXaWRnZXRzIGluIENvZGVNaXJyb3IgRWRpdG9yXG4gICAgc3RhdGljIGNsZWFyV2lkZ2V0cyA9IChjbTogQ29kZU1pcnJvci5FZGl0b3IpID0+IHtcbiAgICAgICAgdmFyIGxhc3RMaW5lID0gY20ubGFzdExpbmUoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbGFzdExpbmU7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgbGluZSA9IGNtLmxpbmVJbmZvKGkpO1xuICAgICAgICAgICAgV2lkZ2V0SGFuZGxlci5jbGVhckxpbmVXaWRnZXRzKGxpbmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2xlYXIgU2luZ2xlIExpbmUgV2lkZ2V0XG4gICAgc3RhdGljIGNsZWFyTGluZVdpZGdldHMgPSAobGluZTogYW55KSA9PiB7XG4gICAgICAgIGlmIChsaW5lLndpZGdldHMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgd2lkIG9mIGxpbmUud2lkZ2V0cykge1xuICAgICAgICAgICAgICAgIGlmICh3aWQuY2xhc3NOYW1lID09PSAnb3otaW1hZ2Utd2lkZ2V0Jykge1xuICAgICAgICAgICAgICAgICAgICB3aWQuY2xlYXIoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufVxuXG5leHBvcnQgY2xhc3MgTGlua0hhbmRsZXIge1xuXG4gICAgc3RhdGljIGxpbmtfcmVnZXggPSAvKGh0dHBbc10/OlxcL1xcLykoW15cXC9cXHNdK1xcLykoLiopLztcbiAgICBzdGF0aWMgaW1hZ2VfaHR0cF9yZWdleF8zID0gLyFcXFtcXFtbYS16XVthLXowLTkrXFwtLl0rOlxcLy4qXFxdXFxdLztcbiAgICBzdGF0aWMgaW1hZ2VfaHR0cF9yZWdleF80ID0gLyFcXFtbXildKlxcXVxcKFthLXpdW2EtejAtOStcXC0uXSs6XFwvW14pXSpcXCkvO1xuXG4gICAgLy8gQ2hlY2sgaWYgU3RyaW5nIGlzIGEgbGlua1xuICAgIHN0YXRpYyBwYXRoX2lzX2FfbGluayA9IChwYXRoOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICAgICAgbGV0IG1hdGNoID0gcGF0aC5tYXRjaChMaW5rSGFuZGxlci5saW5rX3JlZ2V4KTtcbiAgICAgICAgcmV0dXJuIG1hdGNoID8gdHJ1ZSA6IGZhbHNlXG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgbGluZSBpZiBpdCBpcyBhIGxpbmtcbiAgICBzdGF0aWMgZ2V0X2xpbmtfaW5fbGluZSA9IChsaW5lOiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc3QgbWF0Y2hfMyA9IGxpbmUubWF0Y2goTGlua0hhbmRsZXIuaW1hZ2VfaHR0cF9yZWdleF8zKTtcbiAgICAgICAgY29uc3QgbWF0Y2hfNCA9IGxpbmUubWF0Y2goTGlua0hhbmRsZXIuaW1hZ2VfaHR0cF9yZWdleF80KTtcbiAgICAgICAgaWYgKG1hdGNoXzMpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHJlc3VsdDogbWF0Y2hfMywgbGlua1R5cGU6IDMgfTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaF80KSB7XG4gICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG1hdGNoXzQsIGxpbmtUeXBlOiA0IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBmYWxzZSwgbGlua1R5cGU6IDAgfTtcbiAgICB9XG5cbn1cblxuZXhwb3J0IGNsYXNzIFBERkhhbmRsZXIge1xuXG4gICAgLy8gUmVnZXggZm9yIFtbIF1dIGZvcm1hdFxuICAgIHN0YXRpYyBwZGZfcmVnZXhfMSA9IC8hXFxbXFxbLioocGRmKVxcXVxcXS9cbiAgICBzdGF0aWMgcGRmX25hbWVfcmVnZXhfMSA9IC8oPzw9XFxbXFxbKS4qLnBkZi9cblxuICAgIC8vIFJlZ2V4IGZvciAhWyBdKCApIGZvcm1hdFxuICAgIHN0YXRpYyBwZGZfcmVnZXhfMiA9IC8hXFxbKF4kfC4qKVxcXVxcKC4qKHBkZilcXCkvXG4gICAgc3RhdGljIHBkZl9uYW1lX3JlZ2V4XzIgPSAvKD88PVxcKCkuKi5wZGYvO1xuXG4gICAgLy8gQ2hlY2sgbGluZSBpZiBpdCBpcyBhIFBERlxuICAgIHN0YXRpYyBnZXRfcGRmX2luX2xpbmUgPSAobGluZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IG1hdGNoXzEgPSBsaW5lLm1hdGNoKFBERkhhbmRsZXIucGRmX3JlZ2V4XzEpO1xuICAgICAgICBjb25zdCBtYXRjaF8yID0gbGluZS5tYXRjaChQREZIYW5kbGVyLnBkZl9yZWdleF8yKTtcbiAgICAgICAgaWYgKG1hdGNoXzEpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHJlc3VsdDogbWF0Y2hfMSwgbGlua1R5cGU6IDEgfVxuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoXzIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHJlc3VsdDogbWF0Y2hfMiwgbGlua1R5cGU6IDIgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHJlc3VsdDogZmFsc2UsIGxpbmtUeXBlOiAwIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0X3BkZl9uYW1lID0gKGxpbmtUeXBlOiBudW1iZXIsIG1hdGNoOiBhbnkpOiBzdHJpbmcgPT4ge1xuICAgICAgICBsZXQgcGRmX25hbWVfcmVnZXg7XG4gICAgICAgIGlmIChsaW5rVHlwZSA9PSAxKSBwZGZfbmFtZV9yZWdleCA9IFBERkhhbmRsZXIucGRmX25hbWVfcmVnZXhfMTtcbiAgICAgICAgaWYgKGxpbmtUeXBlID09IDIpIHBkZl9uYW1lX3JlZ2V4ID0gUERGSGFuZGxlci5wZGZfbmFtZV9yZWdleF8yO1xuICAgICAgICB2YXIgZmlsZV9uYW1lX21hdGNoID0gbWF0Y2hbMF0ubWF0Y2gocGRmX25hbWVfcmVnZXgpO1xuICAgICAgICByZXR1cm4gZmlsZV9uYW1lX21hdGNoWzBdXG4gICAgfVxuXG59XG5cbmV4cG9ydCBjbGFzcyBJbWFnZUhhbmRsZXIge1xuXG4gICAgLy8gR2VuZXJhbCBJbWFnZSBSZWdleCBcbiAgICBzdGF0aWMgaW1hZ2VfcmVnZXggPSAvLiouKGpwZT9nfHBuZ3xnaWZ8c3ZnfGJtcHxleGNhbGlkcmF3KS9cblxuICAgIC8vIFJlZ2V4IGZvciBbWyBdXSBmb3JtYXRcbiAgICBzdGF0aWMgaW1hZ2VfbGluZV9yZWdleF8xID0gLyFcXFtcXFsuKj8oanBlP2d8cG5nfGdpZnxzdmd8Ym1wfGV4Y2FsaWRyYXcpLio/XFxdXFxdLztcbiAgICBzdGF0aWMgZmlsZV9uYW1lX3JlZ2V4XzEgPSAvKD88PVxcW1xcWykuKihqcGU/Z3xwbmd8Z2lmfHN2Z3xibXB8ZXhjYWxpZHJhdykvO1xuXG4gICAgLy8gUmVnZXggZm9yICFbIF0oICkgZm9ybWF0XG4gICAgc3RhdGljIGltYWdlX2xpbmVfcmVnZXhfMiA9IC8hXFxbKF4kfC4qPylcXF1cXCguKj8oanBlP2d8cG5nfGdpZnxzdmd8Ym1wfGV4Y2FsaWRyYXcpXFwpLztcbiAgICBzdGF0aWMgZmlsZV9uYW1lX3JlZ2V4XzIgPSAvKD88PVxcKCkuKihqcGU/Z3xwbmd8Z2lmfHN2Z3xibXB8ZXhjYWxpZHJhdykvO1xuXG4gICAgLy8gUmVnZXggZm9yIExpbmtzXG4gICAgc3RhdGljIGZpbGVfbmFtZV9yZWdleF8zID0gLyg/PD1cXFtcXFspLiooPz1cXHwpfCg/PD1cXFtcXFspLiooPz1cXF1cXF0pLztcbiAgICBzdGF0aWMgZmlsZV9uYW1lX3JlZ2V4XzQgPSAvKD88PVxcKCkuKig/PVxcKSkvO1xuXG4gICAgLy8gQ2hlY2sgbGluZSBpZiBpdCBpcyBpbWFnZVxuICAgIHN0YXRpYyBnZXRfaW1hZ2VfaW5fbGluZSA9IChsaW5lOiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc3QgbWF0Y2hfMSA9IGxpbmUubWF0Y2goSW1hZ2VIYW5kbGVyLmltYWdlX2xpbmVfcmVnZXhfMSk7XG4gICAgICAgIGNvbnN0IG1hdGNoXzIgPSBsaW5lLm1hdGNoKEltYWdlSGFuZGxlci5pbWFnZV9saW5lX3JlZ2V4XzIpO1xuICAgICAgICBpZiAobWF0Y2hfMSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBtYXRjaF8xLCBsaW5rVHlwZTogMSB9XG4gICAgICAgIH0gZWxzZSBpZiAobWF0Y2hfMikge1xuICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBtYXRjaF8yLCBsaW5rVHlwZTogMiB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBmYWxzZSwgbGlua1R5cGU6IDAgfVxuICAgIH1cblxuICAgIC8vIEltYWdlIE5hbWUgYW5kIEFsdCBUZXh0XG4gICAgc3RhdGljIGdldEZpbGVOYW1lQW5kQWx0VGV4dCA9IChsaW5rVHlwZTogbnVtYmVyLCBtYXRjaDogYW55KSA9PiB7XG4gICAgICAgIC8qIFxuICAgICAgICAgICAgbGlua1R5cGUgMTogIVtbbXlpbWFnZS5qcGd8I3gtc21hbGxdXSwgbGlua1R5cGUgMzogIVtbaHR0cHM6Ly9pbWFnZXwjeC1zbWFsbF1dLCBcbiAgICAgICAgICAgIGxpbmtUeXBlIDI6ICFbI3gtc21hbGxdKG15aW1hZ2UuanBnKSwgIGxpbmtUeXBlIDQ6ICFbI3gtc21hbGxdKGh0dHBzOi8vaW1hZ2UpIFxuICAgICAgICAgICAgcmV0dXJucyB7IGZpbGVOYW1lOiAnJywgYWx0VGV4dDogJycgfSAgIFxuICAgICAgICAqL1xuICAgICAgICB2YXIgZmlsZV9uYW1lX3JlZ2V4O1xuICAgICAgICB2YXIgYWx0X3JlZ2V4O1xuICAgICAgICBpZiAobGlua1R5cGUgPT0gMSB8fCBsaW5rVHlwZSA9PSAzKSB7XG4gICAgICAgICAgICBpZiAobGlua1R5cGUgPT0gMSkgZmlsZV9uYW1lX3JlZ2V4ID0gSW1hZ2VIYW5kbGVyLmZpbGVfbmFtZV9yZWdleF8xO1xuICAgICAgICAgICAgaWYgKGxpbmtUeXBlID09IDMpIGZpbGVfbmFtZV9yZWdleCA9IEltYWdlSGFuZGxlci5maWxlX25hbWVfcmVnZXhfMztcbiAgICAgICAgICAgIGFsdF9yZWdleCA9IC8oPzw9XFx8KS4qKD89XV0pLztcbiAgICAgICAgfSBlbHNlIGlmIChsaW5rVHlwZSA9PSAyIHx8IGxpbmtUeXBlID09IDQpIHtcbiAgICAgICAgICAgIGlmIChsaW5rVHlwZSA9PSAyKSBmaWxlX25hbWVfcmVnZXggPSBJbWFnZUhhbmRsZXIuZmlsZV9uYW1lX3JlZ2V4XzI7XG4gICAgICAgICAgICBpZiAobGlua1R5cGUgPT0gNCkgZmlsZV9uYW1lX3JlZ2V4ID0gSW1hZ2VIYW5kbGVyLmZpbGVfbmFtZV9yZWdleF80O1xuICAgICAgICAgICAgYWx0X3JlZ2V4ID0gLyg/PD1cXFspKF4kfC4qKSg/PVxcXSkvO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGZpbGVfbWF0Y2ggPSBtYXRjaFswXS5tYXRjaChmaWxlX25hbWVfcmVnZXgpO1xuICAgICAgICB2YXIgYWx0X21hdGNoID0gbWF0Y2hbMF0ubWF0Y2goYWx0X3JlZ2V4KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZmlsZU5hbWU6IGZpbGVfbWF0Y2ggPyBmaWxlX21hdGNoWzBdIDogJycsXG4gICAgICAgICAgICBhbHRUZXh0OiBhbHRfbWF0Y2ggPyBhbHRfbWF0Y2hbMF0gOiAnJ1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2hlY2tpbmcgdGhlIEFsdCAxMDB4MTAwIChXSURUSHhIRUlHSFQpIGZvcm1hdFxuICAgIHN0YXRpYyBhbHRXaWR0aEhlaWdodCA9IChhbHRUZXh0OiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc3Qgd2lkdGhIZWlnaHRSZWdleCA9IC9bMC05XSt4WzAtOV0rL1xuICAgICAgICBjb25zdCB3aWR0aFJlZ2V4ID0gL1swLTldKy9cbiAgICAgICAgdmFyIG1hdGNoID0gYWx0VGV4dC5tYXRjaCh3aWR0aEhlaWdodFJlZ2V4KTtcbiAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSBtYXRjaFswXS5pbmRleE9mKCd4Jyk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHdpZHRoOiBwYXJzZUludChtYXRjaFswXS5zdWJzdHIoMCwgaW5kZXgpKSxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHBhcnNlSW50KG1hdGNoWzBdLnN1YnN0cihpbmRleCArIDEpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHdpZHRoTWF0Y2ggPSBhbHRUZXh0Lm1hdGNoKHdpZHRoUmVnZXgpO1xuICAgICAgICAgICAgaWYgKHdpZHRoTWF0Y2gpIHJldHVybiB7IHdpZHRoOiBwYXJzZUludCh3aWR0aE1hdGNoWzBdKSB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgcGF0aCBpcyBhbiBpbWFnZVxuICAgIHN0YXRpYyBpc19hbl9pbWFnZSA9IChwYXRoOiBzdHJpbmcpID0+IHtcbiAgICAgICAgdmFyIG1hdGNoID0gcGF0aC5tYXRjaChJbWFnZUhhbmRsZXIuaW1hZ2VfcmVnZXgpO1xuICAgICAgICBpZiAobWF0Y2gpIHJldHVybiB0cnVlO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG59XG5cbmV4cG9ydCBjbGFzcyBPYnNpZGlhbkhlbHBlcnMge1xuXG4gICAgLy8gR2V0dGluZyBBY3RpdmUgTWFya2Rvd24gRmlsZVxuICAgIHN0YXRpYyBnZXRBY3RpdmVOb3RlRmlsZSA9ICh3b3Jrc3BhY2U6IFdvcmtzcGFjZSkgPT4ge1xuICAgICAgICByZXR1cm4gd29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICB9XG5cbiAgICAvLyBHZXQgQWN0aXZlIEVkaXRvclxuICAgIHN0YXRpYyBnZXRDbUVkaXRvciA9ICh3b3Jrc3BhY2U6IFdvcmtzcGFjZSk6IENvZGVNaXJyb3IuRWRpdG9yID0+IHtcbiAgICAgICAgcmV0dXJuIHdvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LnNvdXJjZU1vZGU/LmNtRWRpdG9yXG4gICAgfVxuXG4gICAgLy8gR2V0IEZ1bGwgUGF0aCBvZiB0aGUgaW1hZ2VcbiAgICBzdGF0aWMgZ2V0UGF0aE9mSW1hZ2UgPSAodmF1bHQ6IFZhdWx0LCBpbWFnZTogVEZpbGUpID0+IHtcbiAgICAgICAgcmV0dXJuIHZhdWx0LmdldFJlc291cmNlUGF0aChpbWFnZSkgKyAnPycgKyBpbWFnZS5zdGF0Lm10aW1lXG4gICAgfVxuXG4gICAgc3RhdGljIGdldEZpbGVDbUJlbG9uZ3NUbyA9IChjbTogQ29kZU1pcnJvci5FZGl0b3IsIHdvcmtzcGFjZTogV29ya3NwYWNlKSA9PiB7XG4gICAgICAgIGxldCBsZWFmcyA9IHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJtYXJrZG93blwiKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZWFmcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgaWYgKGxlYWZzW2ldLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgbGVhZnNbaV0udmlldy5zb3VyY2VNb2RlPy5jbUVkaXRvciA9PSBjbSkge1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICByZXR1cm4gbGVhZnNbaV0udmlldy5maWxlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG59IiwiaW1wb3J0IHsgQXBwLCBub3JtYWxpemVQYXRoLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7XG4gICAgV2lkZ2V0SGFuZGxlciwgTGlua0hhbmRsZXIsIFBERkhhbmRsZXIsXG4gICAgSW1hZ2VIYW5kbGVyLCBPYnNpZGlhbkhlbHBlcnNcbn0gZnJvbSAnLi91dGlscyc7XG5cbi8vIENoZWNrIFNpbmdsZSBMaW5lXG5leHBvcnQgY29uc3QgY2hlY2tfbGluZTogYW55ID0gYXN5bmMgKGNtOiBDb2RlTWlycm9yLkVkaXRvciwgbGluZV9udW1iZXI6IG51bWJlciwgdGFyZ2V0RmlsZTogVEZpbGUsIGFwcDogQXBwLCBzZXR0aW5nczogYW55LCBjaGFuZ2VkRmlsZVBhdGg/OiBzdHJpbmcpID0+IHtcblxuICAgIC8vIEdldCB0aGUgTGluZSBlZGl0ZWRcbiAgICBjb25zdCBsaW5lID0gY20ubGluZUluZm8obGluZV9udW1iZXIpO1xuICAgIGlmIChsaW5lID09PSBudWxsKSByZXR1cm47XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgbGluZSBpcyBhbiBpbnRlcm5ldCBsaW5rXG4gICAgY29uc3QgbGlua19pbl9saW5lID0gTGlua0hhbmRsZXIuZ2V0X2xpbmtfaW5fbGluZShsaW5lLnRleHQpO1xuICAgIGNvbnN0IGltZ19pbl9saW5lID0gSW1hZ2VIYW5kbGVyLmdldF9pbWFnZV9pbl9saW5lKGxpbmUudGV4dCk7XG5cbiAgICAvLyBDbGVhciB0aGUgd2lkZ2V0IGlmIGxpbmsgd2FzIHJlbW92ZWRcbiAgICB2YXIgbGluZV9pbWFnZV93aWRnZXQgPSBsaW5lLndpZGdldHMgPyBsaW5lLndpZGdldHMuZmlsdGVyKCh3aWQ6IHsgY2xhc3NOYW1lOiBzdHJpbmc7IH0pID0+IHdpZC5jbGFzc05hbWUgPT09ICdvei1pbWFnZS13aWRnZXQnKSA6IGZhbHNlO1xuICAgIGlmIChsaW5lX2ltYWdlX3dpZGdldCAmJiAhKGltZ19pbl9saW5lLnJlc3VsdCB8fCBsaW5rX2luX2xpbmUucmVzdWx0KSkgbGluZV9pbWFnZV93aWRnZXRbMF0uY2xlYXIoKTtcblxuICAgIHZhciBzb3VyY2VQYXRoID0gJyc7XG5cbiAgICAvLyBSZW5kZXIgUERGIGlmIGl0IGlzIHR1cm5lZCBvblxuICAgIGlmIChzZXR0aW5ncyAmJiBzZXR0aW5ncy5yZW5kZXJQREYpIHtcblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgbGluZSBpcyBhICBQREYgXG4gICAgICAgIGNvbnN0IHBkZl9pbl9saW5lID0gUERGSGFuZGxlci5nZXRfcGRmX2luX2xpbmUobGluZS50ZXh0KTtcblxuICAgICAgICAvLyBJZiBQREYgUmVnZXggTWF0Y2hlc1xuICAgICAgICBpZiAocGRmX2luX2xpbmUucmVzdWx0KSB7XG5cbiAgICAgICAgICAgIC8vIENsZWFyIHRoZSBMaW5lIFdpZGdldHNcbiAgICAgICAgICAgIFdpZGdldEhhbmRsZXIuY2xlYXJMaW5lV2lkZ2V0cyhsaW5lKTtcblxuICAgICAgICAgICAgLy8gR2V0IFNvdXJjZSBQYXRoXG4gICAgICAgICAgICBpZiAodGFyZ2V0RmlsZSAhPSBudWxsKSBzb3VyY2VQYXRoID0gdGFyZ2V0RmlsZS5wYXRoO1xuXG4gICAgICAgICAgICAvLyBHZXQgUERGIEZpbGVcbiAgICAgICAgICAgIHZhciBwZGZfbmFtZSA9IFBERkhhbmRsZXIuZ2V0X3BkZl9uYW1lKHBkZl9pbl9saW5lLmxpbmtUeXBlLCBwZGZfaW5fbGluZS5yZXN1bHQpO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgVVJMIGZvciBMaW5rIGFuZCBMb2NhbCBQREYgXG4gICAgICAgICAgICB2YXIgcGRmX3BhdGggPSAnJztcblxuICAgICAgICAgICAgaWYgKExpbmtIYW5kbGVyLnBhdGhfaXNfYV9saW5rKHBkZl9uYW1lKSkge1xuICAgICAgICAgICAgICAgIHBkZl9wYXRoID0gcGRmX25hbWVcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBQREYgRmlsZSBPYmplY3RcbiAgICAgICAgICAgICAgICB2YXIgcGRmRmlsZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGRlY29kZVVSSUNvbXBvbmVudChwZGZfbmFtZSksIHNvdXJjZVBhdGgpO1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBPYmplY3QgVVJMXG4gICAgICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IGF3YWl0IGFwcC52YXVsdC5hZGFwdGVyLnJlYWRCaW5hcnkobm9ybWFsaXplUGF0aChwZGZGaWxlLnBhdGgpKTtcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcbiAgICAgICAgICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFthcnJdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgICAgICAgICAgIHBkZl9wYXRoID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBXaWRnZXRcbiAgICAgICAgICAgIHZhciBwZGZfd2lkZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZW1iZWQnKTtcbiAgICAgICAgICAgIHBkZl93aWRnZXQuc3JjID0gcGRmX3BhdGhcbiAgICAgICAgICAgIHBkZl93aWRnZXQudHlwZSA9ICdhcHBsaWNhdGlvbi9wZGYnXG4gICAgICAgICAgICBwZGZfd2lkZ2V0LndpZHRoID0gJzUwMCdcbiAgICAgICAgICAgIHBkZl93aWRnZXQuaGVpZ2h0ID0gJzY1MCdcblxuICAgICAgICAgICAgLy8gQWRkIFdpZGdldCBpbiBMaW5lXG4gICAgICAgICAgICBjbS5hZGRMaW5lV2lkZ2V0KGxpbmVfbnVtYmVyLCBwZGZfd2lkZ2V0LCB7IGNsYXNzTmFtZTogJ296LWltYWdlLXdpZGdldCcgfSlcblxuICAgICAgICAgICAgLy8gRW5kIFJlbmRlcmluZyBvZiB0aGUgbGluZVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiBhbnkgb2YgcmVnZXggbWF0Y2hlcywgaXQgd2lsbCBhZGQgaW1hZ2Ugd2lkZ2V0XG4gICAgaWYgKGxpbmtfaW5fbGluZS5yZXN1bHQgfHwgaW1nX2luX2xpbmUucmVzdWx0KSB7XG5cbiAgICAgICAgLy8gR2V0IHRoZSBmaWxlIG5hbWUgYW5kIGFsdCB0ZXh0IGRlcGVuZGluZyBvbiBmb3JtYXRcbiAgICAgICAgdmFyIGZpbGVuYW1lID0gJyc7XG4gICAgICAgIHZhciBhbHQgPSAnJztcblxuICAgICAgICBpZiAobGlua19pbl9saW5lLnJlc3VsdCkge1xuICAgICAgICAgICAgLy8gbGlua1R5cGUgMyBhbmQgNFxuICAgICAgICAgICAgZmlsZW5hbWUgPSBJbWFnZUhhbmRsZXIuZ2V0RmlsZU5hbWVBbmRBbHRUZXh0KGxpbmtfaW5fbGluZS5saW5rVHlwZSwgbGlua19pbl9saW5lLnJlc3VsdCkuZmlsZU5hbWVcbiAgICAgICAgICAgIGFsdCA9IEltYWdlSGFuZGxlci5nZXRGaWxlTmFtZUFuZEFsdFRleHQobGlua19pbl9saW5lLmxpbmtUeXBlLCBsaW5rX2luX2xpbmUucmVzdWx0KS5hbHRUZXh0XG4gICAgICAgIH0gZWxzZSBpZiAoaW1nX2luX2xpbmUucmVzdWx0KSB7XG4gICAgICAgICAgICBmaWxlbmFtZSA9IEltYWdlSGFuZGxlci5nZXRGaWxlTmFtZUFuZEFsdFRleHQoaW1nX2luX2xpbmUubGlua1R5cGUsIGltZ19pbl9saW5lLnJlc3VsdCkuZmlsZU5hbWU7XG4gICAgICAgICAgICBhbHQgPSBJbWFnZUhhbmRsZXIuZ2V0RmlsZU5hbWVBbmRBbHRUZXh0KGltZ19pbl9saW5lLmxpbmtUeXBlLCBpbWdfaW5fbGluZS5yZXN1bHQpLmFsdFRleHRcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSBJbWFnZVxuICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcblxuICAgICAgICB2YXIgaW1hZ2UgPSBudWxsO1xuXG4gICAgICAgIC8vIFByZXBhcmUgdGhlIHNyYyBmb3IgdGhlIEltYWdlXG4gICAgICAgIGlmIChsaW5rX2luX2xpbmUucmVzdWx0KSB7XG4gICAgICAgICAgICBpbWcuc3JjID0gZmlsZW5hbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBTb3VyY2UgUGF0aFxuICAgICAgICAgICAgaWYgKHRhcmdldEZpbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHNvdXJjZVBhdGggPSB0YXJnZXRGaWxlLnBhdGg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCBhY3RpdmVOb3RlRmlsZSA9IE9ic2lkaWFuSGVscGVycy5nZXRBY3RpdmVOb3RlRmlsZShhcHAud29ya3NwYWNlKTtcbiAgICAgICAgICAgICAgICBzb3VyY2VQYXRoID0gYWN0aXZlTm90ZUZpbGUgPyBhY3RpdmVOb3RlRmlsZS5wYXRoIDogJyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpbWFnZUZpbGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChkZWNvZGVVUklDb21wb25lbnQoZmlsZW5hbWUpLCBzb3VyY2VQYXRoKTtcblxuICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBDaGVjayBmb3IgQ2hhbmdlZCBGaWxlcyAtIGhlbHBzIHVwZGF0aW5nIG9ubHkgZm9yIGNoYW5nZWQgaW1hZ2VcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkRmlsZVBhdGggJiYgaW1hZ2VGaWxlICYmIGNoYW5nZWRGaWxlUGF0aCAhPT0gaW1hZ2VGaWxlLnBhdGgpIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCdleGNhbGlkcmF3JykpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZmlsZSBpcyBhbiBleGNhbGlkcmF3IGRyYXdpbmdcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wbHVnaW5zLmdldFBsdWdpbignb2JzaWRpYW4tZXhjYWxpZHJhdy1wbHVnaW4nKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2VGaWxlID09IG51bGwpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG10aW1lQWx0ID0gaW1hZ2VGaWxlLnN0YXQubXRpbWUgKyAnLScgKyBhbHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkZWREcmF3aW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW210aW1lQWx0PScke210aW1lQWx0fSddYCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkZWREcmF3aW5nID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIEV4Y2FsaWRyYXdBdXRvbWF0ZS5yZXNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBhd2FpdCBFeGNhbGlkcmF3QXV0b21hdGUuY3JlYXRlUE5HKGltYWdlRmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGltYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5zZXRBdHRyKFwibXRpbWVBbHRcIiwgbXRpbWVBbHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFRoZSBmaWxlIGlzIGFuIGltYWdlXG4gICAgICAgICAgICAgICAgaWYgKGltYWdlRmlsZSA9PSBudWxsKSByZXR1cm47XG4gICAgICAgICAgICAgICAgaW1nLnNyYyA9IE9ic2lkaWFuSGVscGVycy5nZXRQYXRoT2ZJbWFnZShhcHAudmF1bHQsIGltYWdlRmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDbGVhciB0aGUgaW1hZ2Ugd2lkZ2V0cyBpZiBleGlzdHNcbiAgICAgICAgV2lkZ2V0SGFuZGxlci5jbGVhckxpbmVXaWRnZXRzKGxpbmUpO1xuXG4gICAgICAgIC8vIEltYWdlIFByb3BlcnRpZXNcbiAgICAgICAgdmFyIGFsdFNpemVyID0gSW1hZ2VIYW5kbGVyLmFsdFdpZHRoSGVpZ2h0KGFsdCk7XG4gICAgICAgIGlmIChhbHRTaXplcikge1xuICAgICAgICAgICAgaW1nLndpZHRoID0gYWx0U2l6ZXIud2lkdGg7XG4gICAgICAgICAgICBpZiAoYWx0U2l6ZXIuaGVpZ2h0KSBpbWcuaGVpZ2h0ID0gYWx0U2l6ZXIuaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgaW1nLmFsdCA9IGFsdDtcblxuICAgICAgICAvLyBBZGQgSW1hZ2Ugd2lkZ2V0IHVuZGVyIHRoZSBJbWFnZSBNYXJrZG93blxuICAgICAgICBjbS5hZGRMaW5lV2lkZ2V0KGxpbmVfbnVtYmVyLCBpbWcsIHsgY2xhc3NOYW1lOiAnb3otaW1hZ2Utd2lkZ2V0JyB9KTtcbiAgICB9XG59XG5cbi8vIENoZWNrIEFsbCBMaW5lcyBGdW5jdGlvblxuZXhwb3J0IGNvbnN0IGNoZWNrX2xpbmVzOiBhbnkgPSAoY206IENvZGVNaXJyb3IuRWRpdG9yLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIsIGFwcDogQXBwLCBzZXR0aW5nczogYW55LCBjaGFuZ2VkRmlsZVBhdGg/OiBzdHJpbmcpID0+IHtcbiAgICAvLyBMYXN0IFVzZWQgTGluZSBOdW1iZXIgaW4gQ29kZSBNaXJyb3JcbiAgICB2YXIgZmlsZSA9IE9ic2lkaWFuSGVscGVycy5nZXRGaWxlQ21CZWxvbmdzVG8oY20sIGFwcC53b3Jrc3BhY2UpO1xuICAgIGZvciAobGV0IGkgPSBmcm9tOyBpIDw9IHRvOyBpKyspIHtcbiAgICAgICAgY2hlY2tfbGluZShjbSwgaSwgZmlsZSwgYXBwLCBzZXR0aW5ncywgY2hhbmdlZEZpbGVQYXRoKTtcbiAgICB9XG59IiwiaW1wb3J0IHsgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE96YW5JbWFnZVBsdWdpbiBmcm9tICcuL21haW4nO1xuXG5leHBvcnQgY2xhc3MgT3phbkltYWdlUGx1Z2luU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IE96YW5JbWFnZVBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE96YW5JbWFnZVBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGxldCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdJbWFnZSBpbiBFZGl0b3IgU2V0dGluZ3MnIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1JlbmRlciBUb2dnbGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1R1cm4gb2ZmIHRoaXMgb3B0aW9uIGlmIHlvdSB3YW50IHRvIHN0b3AgcmVuZGVyaW5nIGltYWdlcywgUERGIGFuZCBkcmF3aW5ncy4gSWYgeW91IHR1cm4gb2ZmLCB0aGUgb3RoZXIgc2V0dGluZ3Mgd29uXFwndCBoYXZlIGFuIGVmZmVjdCcpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW5kZXJBbGwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5oYW5kbGVUb2dnbGVSZW5kZXJBbGwodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW5kZXJBbGwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdSZW5kZXIgUERGLXMgaW4gRWRpdG9yJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUdXJuIG9uIHRoaXMgb3B0aW9uIGlmIHlvdSB3YW50IGFsc28gUERGIGZpbGVzIHRvIGJlIHJlbmRlcmVkIGluIEVkaXRvcicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW5kZXJQREYpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW5kZXJQREYgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdSZWZyZXNoIEltYWdlcyBhZnRlciBDaGFuZ2VzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUdXJuIG9uIHRoaXMgb3B0aW9uIGlmIHlvdSB3YW50IGltYWdlcyB0byByZWZyZXNoZWQgb25jZSB5b3UgZWRpdCB0aGUgb3JpZ2luYWwgZmlsZScpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWZyZXNoSW1hZ2VzQWZ0ZXJDaGFuZ2UpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5oYW5kbGVSZWZyZXNoSW1hZ2VzKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVmcmVzaEltYWdlc0FmdGVyQ2hhbmdlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApXG4gICAgfVxuXG59IiwiaW1wb3J0IHsgUGx1Z2luLCBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IE9ic2lkaWFuSGVscGVycywgV2lkZ2V0SGFuZGxlciwgSW1hZ2VIYW5kbGVyIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBjaGVja19saW5lLCBjaGVja19saW5lcyB9IGZyb20gJy4vY2hlY2stbGluZSc7XG5pbXBvcnQgeyBPemFuSW1hZ2VQbHVnaW5TZXR0aW5nc1RhYiB9IGZyb20gJy4vc2V0dGluZ3MnO1xuXG5pbnRlcmZhY2UgT3phbkltYWdlUGx1Z2luU2V0dGluZ3Mge1xuICAgIHJlbmRlckFsbDogYm9vbGVhbixcbiAgICByZW5kZXJQREY6IGJvb2xlYW4sXG4gICAgcmVmcmVzaEltYWdlc0FmdGVyQ2hhbmdlOiBib29sZWFuLFxufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBPemFuSW1hZ2VQbHVnaW5TZXR0aW5ncyA9IHtcbiAgICByZW5kZXJBbGw6IHRydWUsXG4gICAgcmVuZGVyUERGOiBmYWxzZSxcbiAgICByZWZyZXNoSW1hZ2VzQWZ0ZXJDaGFuZ2U6IGZhbHNlXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE96YW5JbWFnZVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cbiAgICBzZXR0aW5nczogT3phbkltYWdlUGx1Z2luU2V0dGluZ3M7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdJbWFnZSBpbiBFZGl0b3IgUGx1Z2luIGlzIGxvYWRlZCcpO1xuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IE96YW5JbWFnZVBsdWdpblNldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgICAgIC8vIFJlZ2lzdGVyIGV2ZW50IGZvciBlYWNoIGNoYW5nZVxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICd0b2dnbGUtcmVuZGVyLWFsbCcsXG4gICAgICAgICAgICBuYW1lOiAnVG9nZ2xlIFJlbmRlciBBbGwnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVRvZ2dsZVJlbmRlckFsbCghdGhpcy5zZXR0aW5ncy5yZW5kZXJBbGwpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucmVuZGVyQWxsID0gIXRoaXMuc2V0dGluZ3MucmVuZGVyQWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5yZW5kZXJBbGwpIHJldHVybjtcbiAgICAgICAgdGhpcy5yZWdpc3RlckNvZGVNaXJyb3IoKGNtOiBDb2RlTWlycm9yLkVkaXRvcikgPT4ge1xuICAgICAgICAgICAgY20ub24oXCJjaGFuZ2VcIiwgdGhpcy5jb2RlbWlycm9yTGluZUNoYW5nZXMpO1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVJbml0aWFsTG9hZChjbSk7XG4gICAgICAgIH0pXG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5yZWZyZXNoSW1hZ2VzQWZ0ZXJDaGFuZ2UpIHJldHVybjtcbiAgICAgICAgdGhpcy5hcHAudmF1bHQub24oJ21vZGlmeScsIHRoaXMuaGFuZGxlRmlsZU1vZGlmeSk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5pdGVyYXRlQ29kZU1pcnJvcnMoKGNtKSA9PiB7XG4gICAgICAgICAgICBjbS5vZmYoXCJjaGFuZ2VcIiwgdGhpcy5jb2RlbWlycm9yTGluZUNoYW5nZXMpO1xuICAgICAgICAgICAgV2lkZ2V0SGFuZGxlci5jbGVhcldpZGdldHMoY20pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5hcHAudmF1bHQub2ZmKCdtb2RpZnknLCB0aGlzLmhhbmRsZUZpbGVNb2RpZnkpO1xuICAgICAgICBjb25zb2xlLmxvZygnSW1hZ2UgaW4gRWRpdG9yIFBsdWdpbiBpcyB1bmxvYWRlZCcpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIC8vIExpbmUgRWRpdCBDaGFuZ2VzXG4gICAgY29kZW1pcnJvckxpbmVDaGFuZ2VzID0gKGNtOiBhbnksIGNoYW5nZTogYW55KSA9PiB7XG4gICAgICAgIGNoZWNrX2xpbmVzKGNtLCBjaGFuZ2UuZnJvbS5saW5lLCBjaGFuZ2UuZnJvbS5saW5lICsgY2hhbmdlLnRleHQubGVuZ3RoIC0gMSwgdGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIC8vIE9ubHkgVHJpZ2dlcmVkIGR1cmluZyBpbml0aWFsIExvYWRcbiAgICBoYW5kbGVJbml0aWFsTG9hZCA9IChjbTogQ29kZU1pcnJvci5FZGl0b3IpID0+IHtcbiAgICAgICAgdmFyIGxhc3RMaW5lID0gY20ubGFzdExpbmUoKTtcbiAgICAgICAgdmFyIGZpbGUgPSBPYnNpZGlhbkhlbHBlcnMuZ2V0RmlsZUNtQmVsb25nc1RvKGNtLCB0aGlzLmFwcC53b3Jrc3BhY2UpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxhc3RMaW5lICsgMTsgaSsrKSB7XG4gICAgICAgICAgICBjaGVja19saW5lKGNtLCBpLCBmaWxlLCB0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgVG9nZ2xlIGZvciByZW5kZXJBbGxcbiAgICBoYW5kbGVUb2dnbGVSZW5kZXJBbGwgPSAobmV3UmVuZGVyQWxsOiBib29sZWFuKSA9PiB7XG4gICAgICAgIGlmIChuZXdSZW5kZXJBbGwpIHtcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJDb2RlTWlycm9yKChjbTogQ29kZU1pcnJvci5FZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBjbS5vbihcImNoYW5nZVwiLCB0aGlzLmNvZGVtaXJyb3JMaW5lQ2hhbmdlcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVJbml0aWFsTG9hZChjbSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MucmVmcmVzaEltYWdlc0FmdGVyQ2hhbmdlKSB0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgdGhpcy5oYW5kbGVGaWxlTW9kaWZ5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5pdGVyYXRlQ29kZU1pcnJvcnMoKGNtKSA9PiB7XG4gICAgICAgICAgICAgICAgY20ub2ZmKFwiY2hhbmdlXCIsIHRoaXMuY29kZW1pcnJvckxpbmVDaGFuZ2VzKTtcbiAgICAgICAgICAgICAgICBXaWRnZXRIYW5kbGVyLmNsZWFyV2lkZ2V0cyhjbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9mZignbW9kaWZ5JywgdGhpcy5oYW5kbGVGaWxlTW9kaWZ5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSBUb2dnbGUgZm9yIFJlZnJlc2ggSW1hZ2VzXG4gICAgaGFuZGxlUmVmcmVzaEltYWdlcyA9IChuZXdSZWZyZXNoSW1hZ2VzOiBib29sZWFuKSA9PiB7XG4gICAgICAgIGlmIChuZXdSZWZyZXNoSW1hZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgdGhpcy5oYW5kbGVGaWxlTW9kaWZ5KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9mZignbW9kaWZ5JywgdGhpcy5oYW5kbGVGaWxlTW9kaWZ5KVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIEZpbGUgVXBsb2FkXG4gICAgaGFuZGxlRmlsZU1vZGlmeSA9IChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgIGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHJldHVybjtcbiAgICAgICAgaWYgKCFJbWFnZUhhbmRsZXIuaXNfYW5faW1hZ2UoZmlsZS5wYXRoKSkgcmV0dXJuO1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuaXRlcmF0ZUNvZGVNaXJyb3JzKGNtID0+IHtcbiAgICAgICAgICAgIHZhciBsYXN0TGluZSA9IGNtLmxhc3RMaW5lKCk7XG4gICAgICAgICAgICBjaGVja19saW5lcyhjbSwgMCwgbGFzdExpbmUsIHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzLCBmaWxlLnBhdGgpO1xuICAgICAgICB9KVxuICAgIH1cbn0iXSwibmFtZXMiOlsiTWFya2Rvd25WaWV3Iiwibm9ybWFsaXplUGF0aCIsIlBsdWdpblNldHRpbmdUYWIiLCJTZXR0aW5nIiwiUGx1Z2luIiwiVEZpbGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF1REE7QUFDTyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsVUFBVSxFQUFFLENBQUMsRUFBRSxTQUFTLEVBQUU7QUFDN0QsSUFBSSxTQUFTLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxPQUFPLEtBQUssWUFBWSxDQUFDLEdBQUcsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLFVBQVUsT0FBTyxFQUFFLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUU7QUFDaEgsSUFBSSxPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxPQUFPLENBQUMsRUFBRSxVQUFVLE9BQU8sRUFBRSxNQUFNLEVBQUU7QUFDL0QsUUFBUSxTQUFTLFNBQVMsQ0FBQyxLQUFLLEVBQUUsRUFB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
